---
title: "Untitled"
author: "ZN"
date: "2024/12/6"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}

library(geepack)
library(VGAM)
library(CMAverse)
library(dplyr)
options(digits=22)
options(scipen=100)
data <- read.csv("imputed_data241205.csv", fileEncoding = "UTF-8")
data$prosocialT1=0-data$prosocialT1
data$prosocialT3=0-data$prosocialT3
data$who5T1=0-data$who5T1
data$who5T3=0-data$who5T3
####gaming
###adhd
## smfq
#psychopathology and inhibitory control
set.seed(11111)
re=cmest(data = data, model = "rb", outcome = "smfqT3", 
         exposure = "adhdT1", mediator = c("gamingT2"), 
         basec = c("AA1age","girl","BFIQ","behavesubT1","cohesionT1","punishT1","lonelyT1",
                   "incomeT1","bmiT1","smfqT1","QgamingtimeT1","piuT1"), 
         EMint = TRUE, mreg = list("linear"), 
         yreg = "linear", astar = 0, a = 1, mval = list(0), 
         estimation = "para", inference = "delta"
)
summary(re)

re=cmest(data = data, model = "rb", outcome = "cbclaT3", 
         exposure = "adhdT1", mediator = c("gamingT2"), 
         basec = c("AA1age","girl","BFIQ","behavesubT1","cohesionT1","punishT1","lonelyT1",
                   "incomeT1","bmiT1","cbclaT1","QgamingtimeT1","piuT1"), 
         EMint = TRUE, mreg = list("linear"), 
         yreg = "linear", astar = 0, a = 1, mval = list(0), 
         estimation = "para", inference = "delta"
)
summary(re)

set.seed(11111)
re=cmest(data = data, model = "rb", outcome = "apssT3", 
         exposure = "adhdT1", mediator = c("gamingT2"), 
         basec = c("AA1age","girl","BFIQ","behavesubT1","cohesionT1","punishT1","lonelyT1",
                   "incomeT1","bmiT1","apssT1","QgamingtimeT1","piuT1"), 
         EMint = TRUE, mreg = list("linear"), 
         yreg = "linear", astar = 0, a = 1, mval = list(0), 
         estimation = "para", inference = "delta"
)
summary(re)

set.seed(11111)
re=cmest(data = data, model = "rb", outcome = "who5T3", 
         exposure = "adhdT1", mediator = c("gamingT2"), 
         basec = c("AA1age","girl","BFIQ","behavesubT1","cohesionT1","punishT1","lonelyT1",
                   "incomeT1","bmiT1","who5T1","QgamingtimeT1","piuT1"), 
         EMint = TRUE, mreg = list("linear"), 
         yreg = "linear", astar = 0, a = 1, mval = list(0), 
         estimation = "para", inference = "delta"
)
summary(re)


####piu
###adhd
## smfq
#psychopathology and inhibitory control
set.seed(11111)
re=cmest(data = data, model = "rb", outcome = "smfqT3", 
         exposure = "adhdT1", mediator = c("piuT2"), 
         basec = c("AA1age","girl","BFIQ","behavesubT1","cohesionT1","punishT1","lonelyT1",
                   "incomeT1","bmiT1","smfqT1","piuT1"), 
         EMint = TRUE, mreg = list("linear"), 
         yreg = "linear", astar = 0, a = 1, mval = list(0), 
         estimation = "para", inference = "delta"
)
summary(re)

re=cmest(data = data, model = "rb", outcome = "cbclaT3", 
         exposure = "adhdT1", mediator = c("piuT2"), 
         basec = c("AA1age","girl","BFIQ","behavesubT1","cohesionT1","punishT1","lonelyT1",
                   "incomeT1","bmiT1","cbclaT1","piuT1"), 
         EMint = TRUE, mreg = list("linear"), 
         yreg = "linear", astar = 0, a = 1, mval = list(0), 
         estimation = "para", inference = "delta"
)
summary(re)
set.seed(11111)
re=cmest(data = data, model = "rb", outcome = "apssT3", 
         exposure = "adhdT1", mediator = c("piuT2"), 
         basec = c("AA1age","girl","BFIQ","behavesubT1","cohesionT1","punishT1","lonelyT1",
                   "incomeT1","bmiT1","apssT1","piuT1"), 
         EMint = TRUE, mreg = list("linear"), 
         yreg = "linear", astar = 0, a = 1, mval = list(0), 
         estimation = "para", inference = "delta"
)
summary(re)

set.seed(11111)
re=cmest(data = data, model = "rb", outcome = "who5T3", 
         exposure = "adhdT1", mediator = c("piuT2"), 
         basec = c("AA1age","girl","BFIQ","behavesubT1","cohesionT1","punishT1","lonelyT1",
                   "incomeT1","bmiT1","who5T1","piuT1"), 
         EMint = TRUE, mreg = list("linear"), 
         yreg = "linear", astar = 0, a = 1, mval = list(0), 
         estimation = "para", inference = "delta"
)
summary(re)

```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
